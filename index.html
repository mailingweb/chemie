<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Moderne Lernplattform</title>
    <style>
        :root {
            --bg-color: #f5f5f7;
            --text-color: #1d1d1f;
            --nav-bg: rgba(255, 255, 255, 0.85);
            --nav-text: #1d1d1f;
            --nav-hover: rgba(0, 122, 255, 0.08);
            --border-color: rgba(0, 0, 0, 0.05);
            --search-bg: rgba(235, 235, 240, 0.9);
            --search-text: #1d1d1f;
            --button-bg: rgba(0, 122, 255, 0.1);
            --button-text: #007aff;
            --glass-morph: rgba(255, 255, 255, 0.7);
            --glass-border: rgba(255, 255, 255, 0.3);
            --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.05);
            --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.08);
            --shadow-lg: 0 12px 24px rgba(0, 0, 0, 0.12);
            --transition: all 0.4s cubic-bezier(0.25, 0.8, 0.25, 1);
            --blur: 12px;
            --highlight: rgba(0, 122, 255, 0.2);
            --easing: cubic-bezier(0.4, 0, 0.2, 1);
            --button-height: 44px;
            --button-width: 160px;
            --menu-width: 200px;
            --toggle-width: 20px;
            --toggle-height: 120px;
            --sidebar-width: 300px;
            --sidebar-collapsed-margin: -280px;
            --toggle-mode-height: 44px;
        }

        .dark-mode {
            --bg-color: #1a1a1a;
            --text-color: #f5f5f7;
            --nav-bg: rgba(30, 30, 30, 0.85);
            --nav-text: #f5f5f7;
            --nav-hover: rgba(10, 132, 255, 0.12);
            --border-color: rgba(255, 255, 255, 0.05);
            --search-bg: rgba(60, 60, 60, 0.85);
            --search-text: #f5f5f7;
            --button-bg: rgba(10, 132, 255, 0.15);
            --button-text: #00d4ff;
            --glass-morph: rgba(30, 30, 30, 0.75);
            --glass-border: rgba(255, 255, 255, 0.15);
            --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.2);
            --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.2);
            --shadow-lg: 0 12px 24px rgba(0, 0, 0, 0.3);
            --highlight: rgba(0, 122, 255, 0.3);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: var(--bg-color);
            color: var(--text-color);
            display: flex;
            min-height: 100vh;
            transition: margin-left 0.6s var(--easing);
            overflow: hidden;
            height: 100vh;
        }

        .container {
            display: flex;
            width: 100%;
            height: 100vh;
        }

        /* Sidebar */
        .sidebar-wrapper {
            position: fixed;
            left: 0;
            top: 0;
            bottom: 0;
            z-index: 1000;
            display: flex;
            width: var(--sidebar-width);
            transition: transform 0.6s var(--easing);
            transform: translateX(0);
            will-change: transform;
        }

        .sidebar-wrapper.collapsed {
            transform: translateX(var(--sidebar-collapsed-margin));
        }

        .sidebar-toggle {
            width: var(--toggle-width);
            height: var(--toggle-height);
            background-color: var(--glass-morph);
            backdrop-filter: blur(var(--blur));
            border: 1px solid var(--glass-border);
            border-left: none;
            border-radius: 0 12px 12px 0;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0.4;
            transition: opacity 0.3s var(--easing), background 0.3s var(--easing);
            z-index: 1001;
            position: absolute;
            right: -20px;
            top: 50%;
            transform: translateY(-50%);
            box-shadow: var(--shadow-md);
        }

        .sidebar-toggle:hover {
            opacity: 1;
            background-color: var(--glass-morph);
        }

        .sidebar-toggle::after {
            content: "◀";
            color: var(--nav-text);
            font-size: 12px;
            font-weight: 600;
        }

        .sidebar-wrapper.collapsed .sidebar-toggle::after {
            content: "▶";
        }

        .sidebar {
            width: 100%;
            background-color: var(--nav-bg);
            backdrop-filter: blur(var(--blur));
            color: var(--nav-text);
            padding: 25px;
            height: 100vh;
            border-right: 1px solid var(--border-color);
            overflow-y: auto;
            box-shadow: var(--shadow-md);
            border-radius: 0 20px 20px 0;
            transition: padding 0.6s var(--easing);
            will-change: padding;
        }

        .sidebar.collapsed {
            padding: 25px 10px;
        }

        .search-container {
            position: relative;
            width: 100%;
            margin-bottom: 25px;
            opacity: 1;
            height: auto;
            transition: opacity 0.4s var(--easing), margin-bottom 0.4s var(--easing);
        }

        .sidebar.collapsed .search-container {
            opacity: 0;
            height: 0;
            margin-bottom: 0;
            pointer-events: none;
        }

        .search-box {
            width: 100%;
            padding: 12px 45px 12px 15px;
            border: 1px solid var(--glass-border);
            border-radius: 12px;
            background-color: var(--search-bg);
            color: var(--search-text);
            box-sizing: border-box;
            font-size: 14px;
            transition: all 0.3s var(--easing);
            box-shadow: var(--shadow-sm);
            backdrop-filter: blur(var(--blur));
            will-change: border-color;
        }

        .search-box:focus {
            outline: none;
            border-color: var(--button-text);
            box-shadow: 0 0 0 3px var(--highlight);
        }

        .clear-search {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            background-color: transparent;
            color: var(--nav-text);
            border: none;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            cursor: pointer;
            display: none;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            transition: all 0.2s var(--easing);
        }

        .clear-search:hover {
            background-color: var(--nav-hover);
        }

        .content-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .content-list li {
            padding: 6px 0;
            transition: none;
            border-radius: 8px;
            white-space: normal !important;
            word-wrap: break-word !important;
            position: relative;
        }

        .content-list li a {
            text-decoration: none;
            color: var(--nav-text);
            display: block;
            padding: 8px 15px;
            border-radius: 8px;
            transition: none;
            position: relative;
            z-index: 1;
            white-space: normal !important;
            word-wrap: break-word !important;
        }

        .category {
            font-weight: 600;
            margin-top: 20px;
            font-size: 1.1em;
            padding: 0 10px;
            color: var(--button-text);
            transition: none;
        }

        .subcategory {
            font-weight: 500;
            margin-top: 12px;
            margin-left: 10px;
            font-size: 0.95em;
            color: var(--button-text);
            padding: 0 10px;
            transition: none;
        }

        .entry {
            margin-left: 20px;
            padding: 8px 15px;
            border-radius: 8px;
            cursor: pointer;
            transition: none;
            position: relative;
            overflow: hidden;
        }

        .entry::before {
            content: "";
            position: absolute;
            inset: 0;
            background-color: var(--nav-hover);
            border-radius: 8px;
            opacity: 0;
            transition: opacity 0.25s var(--easing);
            pointer-events: none;
            z-index: -1;
        }

        .entry a {
            display: block;
            padding: inherit;
            border-radius: inherit;
            transition: none;
        }

        .entry:hover::before {
            opacity: 1;
        }

        .entry:active::before {
            opacity: 1;
        }

        /* Main Content */
        .main-content {
            margin-left: var(--sidebar-width);
            padding: 30px;
            width: calc(100% - var(--sidebar-width));
            transition: margin-left 0.6s var(--easing), width 0.6s var(--easing);
            will-change: margin-left, width;
            overflow: hidden;
            height: 100vh;
        }

        .main-content.expanded {
            margin-left: var(--toggle-width);
            width: calc(100% - var(--toggle-width));
        }

        .iframe-container {
            width: 100%;
            height: calc(100vh - 60px);
            border: none;
            border-radius: 15px;
            background-color: var(--glass-morph);
            backdrop-filter: blur(var(--blur));
            box-shadow: var(--shadow-lg);
            transition: all 0.4s var(--easing);
            will-change: border-radius, box-shadow;
            overflow: auto;
        }

        /* Toggle Mode Button Wrapper */
        .toggle-mode-wrapper {
            position: fixed;
            right: 55px;
            top: 40px;
            z-index: 1000;
            display: flex;
            align-items: center;
            transition: transform 0.6s var(--easing);
            transform: translateX(0);
            will-change: transform;
            height: var(--toggle-mode-height);
        }

        .toggle-mode-wrapper.collapsed {
            transform: translateX(calc(100% + 30px));
        }

        .toggle-mode-toggle {
            width: var(--toggle-width);
            height: var(--toggle-mode-height);
            border: 1px solid var(--glass-border);
            border-right: none;
            border-radius: 12px 0 0 12px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0.4;
            transition: opacity 0.3s var(--easing), background 0.3s var(--easing);
            z-index: 1001;
            margin-right: 20px;
            box-shadow: var(--shadow-md);
            backdrop-filter: blur(var(--blur));
            will-change: opacity;
        }

        .toggle-mode-toggle:hover {
            opacity: 1;
        }

        .toggle-mode-toggle::after {
            content: "▶";
            font-size: 12px;
            font-weight: 600;
        }

        .toggle-mode-wrapper.collapsed .toggle-mode-toggle::after {
            content: "◀";
        }

        .toggle-mode-container {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            gap: 10px;
            margin-left: -15px;
            transition: all 0.4s var(--easing);
            will-change: transform;
            height: var(--toggle-mode-height);
        }

        .toggle-mode {
            width: var(--toggle-mode-height);
            height: var(--toggle-mode-height);
            padding: 0;
            background: var(--glass-morph);
            backdrop-filter: blur(var(--blur));
            border-radius: 50%;
            border: 1px solid var(--glass-border);
            color: var(--nav-text);
            cursor: pointer;
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            transition: transform 0.2s var(--easing), background-color 0.2s var(--easing);
            box-shadow: var(--shadow-md);
        }

        /* Hover-Effekt für Light/Dark Mode Toggle (nur Desktop) */
        @media (hover: hover) {
            .toggle-mode:hover {
                transform: scale(1.05);
                background-color: rgba(0, 122, 255, 0.2);
            }
        }

        .toggle-mode:active {
            transform: scale(0.98);
        }

        /* Floating Buttons */
        .floating-button-wrapper {
            position: fixed;
            right: 55px;
            bottom: 45px;
            z-index: 1000;
            display: flex;
            align-items: center;
            transition: transform 0.6s var(--easing);
            transform: translateX(0);
            will-change: transform;
        }

        .floating-button-wrapper.collapsed {
            transform: translateX(calc(100% + 30px));
        }

        .floating-button-toggle {
            width: var(--toggle-width);
            height: var(--toggle-height);
            background-color: var(--button-bg);
            color: var(--button-text);
            border: 1px solid var(--glass-border);
            border-right: none;
            border-radius: 12px 0 0 12px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0.4;
            transition: opacity 0.3s var(--easing), background 0.3s var(--easing);
            z-index: 1001;
            margin-right: 20px;
            box-shadow: var(--shadow-md);
            backdrop-filter: blur(var(--blur));
            will-change: opacity;
        }

        .floating-button-toggle:hover {
            opacity: 1;
        }

        .floating-button-toggle::after {
            content: "▶";
            color: var(--button-text);
            font-size: 12px;
            font-weight: 600;
        }

        .floating-button-wrapper.collapsed .floating-button-toggle::after {
            content: "◀";
        }

        .floating-button-container {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            gap: 10px;
            margin-left: -15px;
            transition: all 0.4s var(--easing);
            will-change: transform;
        }

        .floating-button {
            width: var(--button-width);
            height: var(--button-height);
            text-align: center;
            background-color: var(--glass-morph);
            color: var(--button-text);
            border: 1px solid var(--glass-border);
            border-radius: 12px;
            cursor: pointer;
            padding: 0 15px;
            box-sizing: border-box;
            font-weight: 500;
            box-shadow: var(--shadow-md);
            backdrop-filter: blur(var(--blur));
            transition: transform 0.2s var(--easing), background-color 0.2s var(--easing);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            position: relative;
            overflow: hidden;
        }

        /* Hover-Effekt nur für Desktop-Geräte */
        @media (hover: hover) {
            .floating-button:hover {
                transform: translateY(-2px);
                background-color: rgba(0, 122, 255, 0.2);
            }
        }

        .floating-button:active {
            transform: scale(0.98);
        }

        .floating-button span {
            font-size: 16px;
        }

        #frageButton {
            background: linear-gradient(135deg, rgba(255, 159, 10, 0.1), rgba(255, 159, 10, 0.15));
            border: 1px solid rgba(255, 159, 10, 0.2);
            color: #ff9f0a;
        }

        #zusammenfassungButton {
            background: linear-gradient(135deg, rgba(0, 122, 255, 0.1), rgba(0, 122, 255, 0.15));
            border: 1px solid rgba(0, 122, 255, 0.2);
            color: #007aff;
        }

        #quizButton {
            background: linear-gradient(135deg, rgba(50, 215, 75, 0.1), rgba(50, 215, 75, 0.15));
            border: 1px solid rgba(50, 215, 75, 0.2);
            color: #32d74b;
        }

        /* Frage-Menü */
        .input-menu {
            position: absolute;
            bottom: calc(100% + 10px);
            right: 0;
            width: var(--menu-width);
            background-color: var(--glass-morph);
            backdrop-filter: blur(var(--blur));
            border: 1px solid var(--glass-border);
            border-radius: 12px;
            padding: 15px;
            box-sizing: border-box;
            display: none;
            z-index: 1002;
            box-shadow: var(--shadow-lg);
            transition: all 0.4s var(--easing), opacity 0.3s var(--easing);
            opacity: 0;
            transform: translateY(10px);
            will-change: opacity, transform;
        }

        .input-menu.show {
            display: block;
            opacity: 1;
            transform: translateY(0);
        }

        .input-menu input {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            background-color: var(--search-bg);
            color: var(--search-text);
            box-sizing: border-box;
            font-size: 14px;
            transition: all 0.2s var(--easing);
            will-change: border-color, box-shadow;
        }

        .input-menu input:focus {
            outline: none;
            border-color: var(--button-text);
            box-shadow: 0 0 0 2px var(--highlight);
        }

        .input-menu::after {
            content: "";
            position: absolute;
            bottom: -8px;
            right: 15px;
            width: 0;
            height: 0;
            border-left: 8px solid transparent;
            border-right: 8px solid transparent;
            border-top: 8px solid var(--glass-morph);
            filter: blur(2px);
        }

        h1 {
            margin-top: 0;
            font-size: 1.5em;
            font-weight: 600;
            padding: 0 10px;
            color: var(--button-text);
        }

        /* Toast Notification */
        .toast-notification {
            position: fixed;
            top: -70px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(135deg, rgba(0, 122, 255, 0.95), rgba(0, 122, 255, 0.8));
            color: white;
            padding: 15px 30px;
            border-radius: 12px;
            box-shadow: var(--shadow-lg);
            z-index: 1001;
            transition: top 0.5s var(--easing), opacity 0.4s var(--easing);
            opacity: 0;
            pointer-events: none;
            backdrop-filter: blur(var(--blur));
            border: 1px solid var(--glass-border);
            will-change: top, opacity;
        }

        .toast-notification.show {
            top: 30px;
            opacity: 1;
            pointer-events: auto;
        }

        /* Animation für Sidebar-Einträge */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-15px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .content-list li {
            animation: fadeIn 0.4s var(--easing) forwards;
        }

        @keyframes slideIn {
            from { transform: translateX(-20px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        .sidebar:not(.collapsed) .content-list li {
            animation: slideIn 0.3s var(--easing) forwards;
        }
    </style>
</head>
<body>
    <div class="toggle-mode-wrapper collapsed">
        <div class="toggle-mode-toggle" id="toggleModeToggle"></div>
        <div class="toggle-mode-container">
            <button class="toggle-mode" id="toggleMode">☽</button>
        </div>
    </div>

    <div class="sidebar-wrapper">
        <div class="sidebar">
            <h1>Inhaltsverzeichnis</h1>
            <div class="search-container">
                <input type="text" id="searchInput" class="search-box" placeholder="Suche...">
                <button class="clear-search" id="clearSearch">×</button>
            </div>
            <ul class="content-list" id="contentList">
                <!-- Wird per JavaScript gefüllt -->
            </ul>
        </div>
        <div class="sidebar-toggle" id="sidebarToggle"></div>
    </div>

    <div class="floating-button-wrapper">
        <div class="floating-button-toggle" id="floatingButtonToggle"></div>
        <div class="floating-button-container">
            <button class="floating-button" id="frageButton">
                <span>Frage stellen</span>
            </button>
            <div class="input-menu" id="frageInputMenu">
                <input type="text" id="frageInput" placeholder="Frage + Enter">
            </div>
            <button class="floating-button" id="zusammenfassungButton">
                <span>Zusammenfassen</span>
            </button>
            <button class="floating-button" id="quizButton">
                <span>Quiz erstellen</span>
            </button>
        </div>
    </div>

    <div class="container">
        <div class="main-content">
            <iframe class="iframe-container" id="contentFrame" src=""></iframe>
        </div>
    </div>

    <script>
        // Levenshtein-Distanz-Algorithmus
        function levenshtein(a, b) {
            if (a.length === 0) return b.length;
            if (b.length === 0) return a.length;
            const matrix = [];
            for (let i = 0; i <= b.length; i++) matrix[i] = [i];
            for (let j = 0; j <= a.length; j++) matrix[0][j] = j;
            for (let i = 1; i <= b.length; i++) {
                for (let j = 1; j <= a.length; j++) {
                    if (b.charAt(i-1) === a.charAt(j-1)) {
                        matrix[i][j] = matrix[i-1][j-1];
                    } else {
                        matrix[i][j] = Math.min(
                            matrix[i-1][j-1] + 1,
                            matrix[i][j-1] + 1,
                            matrix[i-1][j] + 1
                        );
                    }
                }
            }
            return matrix[b.length][a.length];
        }

        // Fuzzy-Matching
        function isFuzzyMatch(str, term) {
            return levenshtein(str.toLowerCase(), term.toLowerCase()) <= 2;
        }

        // Inhaltsliste
        const contentList = [
            {
                "category": "Organische Chemie",
                "subcategory": "Experimente",
                "displayName": "Experiment Ethin",
                "fileName": "e_ethin.html",
                "tags": ["Ethin", "Alkin", "Nachweis", "Dreifachbindung", "Organische Synthese", "Bunsenbrenner"]
            },
            {
                "category": "Physikalische Chemie",
                "subcategory": "Thermodynamik",
                "displayName": "Chemische Thermodynamik",
                "fileName": "u_chemische_thermodynamik.html",
                "tags": ["Thermodynamik", "Energie", "Enthalpie", "Entropie", "Gibbs-Energie", "Spontanität"]
            },
            {
                "category": "Allgemeine Chemie",
                "subcategory": "Grundlagen",
                "displayName": "Arten stofflicher Systeme",
                "fileName": "u_arten_stofflicher_systeme.html",
                "tags": ["Stoffsysteme", "Homogen", "Heterogen", "Phasen", "Gemische", "Reinstoffe"]
            },
            {
                "category": "Physikalische Chemie",
                "subcategory": "Thermodynamik",
                "displayName": "Volumen Arbeit",
                "fileName": "u_volumen_arbeit.html",
                "tags": ["Volumenarbeit", "Arbeit", "Gasgesetze", "Thermodynamik", "Energieumwandlung", "p-V-Diagramm"]
            },
            {
                "category": "Allgemeine Chemie",
                "subcategory": "Stoffmengenberechnungen",
                "displayName": "Mol Berechnungen",
                "fileName": "u_mol_hcl_c_berechnungen.html",
                "tags": ["Mol", "Stoffmenge", "Konzentration", "Berechnung", "Avogadro", "Stöchiometrie"]
            },
            {
                "category": "Allgemeine Chemie",
                "subcategory": "Reaktionsarten",
                "displayName": "Reaktionsarten Übersicht",
                "fileName": "u_reaktionsarten.html",
                "tags": ["Reaktionsarten", "Synthese", "Analyse", "Umlagerung", "Redoxreaktion", "Säure-Base"]
            },
            {
                "category": "Analytische Chemie",
                "subcategory": "Nachweisreaktionen",
                "displayName": "Nachweisreaktionen Übersicht",
                "fileName": "u_nachweisreaktionen.html",
                "tags": ["Nachweis", "Analyse", "Ionen", "Fällung", "Flammenfärbung", "Indikator"]
            },
            {
                "category": "Anorganische Chemie",
                "subcategory": "Atombau und Bindung",
                "displayName": "Atombau, Orbitale, Hybridisierung",
                "fileName": "u_atombau_orbitale_hybridisierung.html",
                "tags": ["Atombau", "Orbitale", "Hybridisierung", "Elektronenkonfiguration", "sp³", "Molekülgeometrie"]
            },
            {
                "category": "Anorganische Chemie",
                "subcategory": "Redoxreaktionen",
                "displayName": "Redoxreaktionen und Disproportionierung",
                "fileName": "redoxreaktionen_dis.html",
                "tags": ["Redoxreaktion", "Oxidation", "Reduktion", "Disproportionierung", "Elektronenübertragung", "Oxidationszahl"]
            },
            {
                "category": "Physikalische Chemie",
                "subcategory": "Chemisches Gleichgewicht",
                "displayName": "Chemische Gleichgewichte - Massenwirkungsgesetz",
                "fileName": "chemische_gleichgewichte_mwg.html",
                "tags": ["Gleichgewicht", "Massenwirkungsgesetz", "Kc", "Dynamisches Gleichgewicht", "Le Chatelier", "Reaktionsquotient"]
            },
            {
                "category": "Allgemeine Chemie",
                "subcategory": "Stoffmengenberechnungen",
                "displayName": "Weitere Berechnungen Mol, chemisches GG",
                "fileName": "berechnungen_mol_2.html",
                "tags": ["Mol", "Gleichgewicht", "Berechnung", "Stöchiometrie", "Konzentration", "Kc"]
            },
            {
                "category": "Physikalische Chemie",
                "subcategory": "Thermodynamik",
                "displayName": "Reaktionsenthalpie (Berechnung) Erklärung und Beispiel",
                "fileName": "reaktionsenthalpie_erklaerung_u_bsp.html",
                "tags": ["Reaktionsenthalpie", "Berechnung", "Enthalpie", "Exotherm", "Endotherm", "Energiebilanz"]
            },
            {
                "category": "Physikalische Chemie",
                "subcategory": "Thermodynamik",
                "displayName": "Reaktionsenthalpie (Berechnung) Erklärung 2",
                "fileName": "reaktionsenthalpie_rechnung_detailliert.html",
                "tags": ["Reaktionsenthalpie", "Berechnung", "Hess’scher Satz", "Standardbildungsenthalpie", "Energie", "Thermochemie"]
            },
            {
                "category": "Anorganische Chemie",
                "subcategory": "Redoxreaktionen",
                "displayName": "Oxidationszahlen und Beispiele",
                "fileName": "oxidationszahlen_rechnung_1.html",
                "tags": ["Oxidationszahl", "Redox", "Bestimmung", "Regeln", "Beispiele", "Elektronegativität"]
            },
            {
                "category": "Physikalische Chemie",
                "subcategory": "Thermodynamik",
                "displayName": "2. Hauptsatz der Thermodynamik, Entropie, Gibbs-Helmholtz-Gleichung, Spontanität",
                "fileName": "zweiter_hauptsatz_thermodynamik.html",
                "tags": ["2. Hauptsatz", "Entropie", "Gibbs-Helmholtz", "Spontanität", "Freie Enthalpie", "ΔG"]
            },
            {
                "category": "Physikalische Chemie",
                "subcategory": "Thermodynamik",
                "displayName": "Gibbs Helmholtz Gleichung Beispiel, Spontanität",
                "fileName": "gibbs_helmholtz_beispiel_1.html",
                "tags": ["Gibbs-Helmholtz", "Spontanität", "ΔG", "ΔH", "ΔS", "T"]
            },
            {
                "category": "Anorganische Chemie",
                "subcategory": "Industrielle Prozesse",
                "displayName": "Ammoniaksynthese, Le Chatelier, Chemisches GG",
                "fileName": "ammoniaksynthese_1.html",
                "tags": ["Ammoniaksynthese", "Haber-Bosch", "Le Chatelier", "Gleichgewicht", "Katalysator", "Druck"]
            },
            {
                "category": "Anorganische Chemie",
                "subcategory": "Industrielle Prozesse",
                "displayName": "Stickstoffmonoxid (technische Herstellung nach Ostwald), Le Chatelier, Chemisches GG",
                "fileName": "stickstoffmonoxid_ostwald.html",
                "tags": ["Stickstoffmonoxid", "Ostwald-Verfahren", "Le Chatelier", "Gleichgewicht", "Katalysator", "Salpetersäure"]
            },
            {
                "category": "Anorganische Chemie",
                "subcategory": "Industrielle Prozesse",
                "displayName": "Kohlenstoff - Verbrennung im Hochofen, Le Chatelier, Chemisches GG",
                "fileName": "kohlenstoff_hochoffen.html",
                "tags": ["Hochofen", "Kohlenstoff", "Eisenherstellung", "Reduktion", "Le Chatelier", "Rost"]
            },
            {
                "category": "Anorganische Chemie",
                "subcategory": "Industrielle Prozesse",
                "displayName": "Großtechnische Herstellung von Schwefelsäure, Le Chatelier, Chemisches GG",
                "fileName": "grosstechnische_herstellung_schwefelsaeure.html",
                "tags": ["Schwefelsäure", "Kontaktverfahren", "Le Chatelier", "Gleichgewicht", "Katalysator", "SO₃"]
            },
            {
                "category": "Organische Chemie",
                "subcategory": "Industrielle Prozesse",
                "displayName": "Großtechnische Herstellung von Methanol, Le Chatelier, Chemisches GG",
                "fileName": "grosstechnische_herstellung_methanol.html",
                "tags": ["Methanol", "Synthesegas", "Le Chatelier", "Gleichgewicht", "Katalysator", "Hydrierung"]
            },
            {
                "category": "Organische Chemie",
                "subcategory": "Biochemie",
                "displayName": "Gärungsprozess, Essigsäure",
                "fileName": "gaerung_essigsaeure.html",
                "tags": ["Gärung", "Essigsäure", "Fermentation", "Ethanol", "Bakterien", "Biochemie"]
            },
            {
                "category": "Organische Chemie",
                "subcategory": "Historische Experimente",
                "displayName": "Harnstoffsynthese nach Wöhler, Organische Chemie",
                "fileName": "harnstoffsynthese_org_chemie.html",
                "tags": ["Harnstoffsynthese", "Wöhler", "Organische Chemie", "Harnstoff", "Ammoniumcyanat", "Isomerie"]
            },
            {
                "category": "Organische Chemie",
                "subcategory": "Grundlagen",
                "displayName": "Kohlenwasserstoffe, Isomerie, Organische Chemie Übersicht",
                "fileName": "org_chemie_kohlenwasserstoffe_isomerie.html",
                "tags": ["Kohlenwasserstoffe", "Isomerie", "Alkane", "Alkene", "Alkine", "Strukturformel"]
            },
            {
                "category": "Organische Chemie",
                "subcategory": "Funktionelle Gruppen",
                "displayName": "Funktionelle Gruppen, Organische Chemie",
                "fileName": "org_chemie_funktionelle_gruppen.html",
                "tags": ["Funktionelle Gruppen", "Alkohol", "Carbonsäure", "Amin", "Keton", "Ester"]
            },
            {
                "category": "Organische Chemie",
                "subcategory": "Reaktionstypen",
                "displayName": "Reaktionstypen organische Chemie, Substitution, Addition",
                "fileName": "reaktionstypen_org_chemie.html",
                "tags": ["Reaktionstypen", "Substitution", "Addition", "Eliminierung", "Radikalisch", "Nukleophil"]
            },
            {
                "category": "Organische Chemie",
                "subcategory": "Reaktionsmechanismen",
                "displayName": "Carbenium, Carbanion, Zwischenstufen organischer Reaktionen",
                "fileName": "carbenium_carbanion_zwischenstufen.html",
                "tags": ["Carbenium", "Carbanion", "Zwischenstufen", "Reaktionsmechanismus", "Ladung", "Stabilität"]
            },
            {
                "category": "Analytische Chemie",
                "subcategory": "Organische Analyse",
                "displayName": "Qualitative Analyse organischer Stoffe und Nachweise",
                "fileName": "qualitative_analyse_organischer_stoffe_und_nachweise.html",
                "tags": ["Qualitative Analyse", "Nachweis", "Organische Stoffe", "Flammenprobe", "Löslichkeit", "Funktionelle Gruppe"]
            },
            {
                "category": "Analytische Chemie",
                "subcategory": "Quantitative Analyse",
                "displayName": "Quantitative Analyse, Kolbenprober, Kupfer(II)-oxid",
                "fileName": "quantitative_analyse_kolbenprober_cuo.html",
                "tags": ["Quantitative Analyse", "Kolbenprober", "Kupfer(II)-oxid", "Verbrennung", "CO₂-Nachweis", "Wasser"]
            },
            {
                "category": "Analytische Chemie",
                "subcategory": "Organische Analyse",
                "displayName": "Nachweis ungesättigter Kohlenwasserstoffe",
                "fileName": "nachweis_ungesaettigter_kohlenwasserstoffe.html",
                "tags": ["Ungesättigte Kohlenwasserstoffe", "Bromwasser", "Entfärbung", "Alkene", "Alkine", "Doppelbindung"]
            },
            {
                "category": "Organische Chemie",
                "subcategory": "Biochemie",
                "displayName": "Glucose Nachweis, Tollensreagenz, Fehling",
                "fileName": "glucose_nachweis.html",
                "tags": ["Glucose", "Tollensreagenz", "Fehling", "Aldehyd", "Reduktion", "Silberspiegel"]
            },
            {
                "category": "Organische Chemie",
                "subcategory": "Biochemie",
                "displayName": "Nachweis Polysaccharide, Iod-Iodid-Lösung",
                "fileName": "nachweis_polysaccharide_iod_iodid.html",
                "tags": ["Polysaccharide", "Stärke", "Iod-Iodid", "Blaufärbung", "Nachweis", "Cellulose"]
            },
            {
                "category": "Organische Chemie",
                "subcategory": "Biochemie",
                "displayName": "Fettsäuren, Nachweise, Aufbau, Abbau",
                "fileName": "fettsaeuren_nachweis_abbau_aufbau.html",
                "tags": ["Fettsäuren", "Nachweis", "Ester", "Seifen", "Hydrolyse", "Triglyceride"]
            },
            {
                "category": "Biochemie",
                "subcategory": "Proteine",
                "displayName": "Proteine Übersicht, Polare, Unpolare Aminosäuren",
                "fileName": "proteine_uebersicht_polare_unpolare_as.html",
                "tags": ["Proteine", "Aminosäuren", "Polar", "Unpolar", "Peptidbindung", "Struktur"]
            },
            {
                "category": "Biochemie",
                "subcategory": "Proteine",
                "displayName": "Proteine, Primär-, Sekundär-, Tertiärstruktur",
                "fileName": "primaer_sekundaer_struktur_proteine.html",
                "tags": ["Proteine", "Primärstruktur", "Sekundärstruktur", "Tertiärstruktur", "α-Helix", "Faltung"]
            },
            {
                "category": "Biochemie",
                "subcategory": "Proteine",
                "displayName": "Peptidbindung, Eigenschaften Proteine, Xanthoprotein-, Biuretreaktion",
                "fileName": "peptidbindung_1.html",
                "tags": ["Peptidbindung", "Xanthoprotein", "Biuret", "Nachweis", "Denaturierung", "Farbreaktion"]
            },
            {
                "category": "Organische Chemie",
                "subcategory": "Stereochemie",
                "displayName": "Stereoisomerie, Spiegelbildisomerie, Fischer-Projektion",
                "fileName": "stereoisomerie_spiegelbildisomerie_fischer.html",
                "tags": ["Stereoisomerie", "Enantiomere", "Chiralität", "Fischer-Projektion", "D/L-Nomenklatur", "Optische Aktivität"]
            },
            {
                "category": "Organische Chemie",
                "subcategory": "Zuckerchemie",
                "displayName": "Aldosen, Ketosen, Keto-Enol-Tautomerie",
                "fileName": "aldosen_ketosen_keto_enol_tautomerie.html",
                "tags": ["Aldosen", "Ketosen", "Tautomerie", "Glucose", "Fructose", "Ringform"]
            },
            {
                "category": "Anorganische Chemie",
                "subcategory": "Bindungstheorie",
                "displayName": "Chemische Bindungen, Primär-, Sekundärbindungen",
                "fileName": "chemische_bindungen_primaer_intra_sekundaer_inter.html",
                "tags": ["Bindungen", "Primärbindung", "Sekundärbindung", "Ionenbindung", "Wasserstoffbrücke", "Van-der-Waals"]
            },
            {
                "category": "Anorganische Chemie",
                "subcategory": "Bindungstheorie",
                "displayName": "Valenzbindungsmodell, Molekülorbitalmodell",
                "fileName": "valenzbindungsmodell_molekuelorbitalmodell.html",
                "tags": ["Valenzbindungsmodell", "Molekülorbital", "Hybridisierung", "σ-Bindung", "π-Bindung", "Delokalisierung"]
            },
            {
                "category": "Anorganische Chemie",
                "subcategory": "Redoxreaktionen",
                "displayName": "Oxidationsstufen des Mangans, Experiment, Elektronenkonfiguration",
                "fileName": "oxdiationsstufen_des_mangans.html",
                "tags": ["Mangan", "Oxidationsstufen", "Permanganat", "Fällung", "Farbreaktion", "d-Orbitale"]
            },
            {
                "category": "Anorganische Chemie",
                "subcategory": "Redoxreaktionen",
                "displayName": "Proportionierung, Disproportionierung, Autokatalyse",
                "fileName": "proportionierung_und_disproportionierung_beispiele.html",
                "tags": ["Proportionierung", "Disproportionierung", "Autokatalyse", "Chlor", "Wasserstoffperoxid", "Redox"]
            },
            {
                "category": "Anorganische Chemie",
                "subcategory": "Redoxreaktionen",
                "displayName": "Redoxampholyte, Amphoterer Charakter in Redoxreaktionen",
                "fileName": "redoxampholyt_amphoterer_charakter.html",
                "tags": ["Redoxampholyt", "Amphoter", "Wasserstoffperoxid", "Schwefel", "Oxidation", "Reduktion"]
            },
            {
                "category": "Physikalische Chemie",
                "subcategory": "Elektrochemie",
                "displayName": "Elektrochemie, Bleiakkumulator, Elektrolyte",
                "fileName": "elektrochemie_bleiakkumulator.html",
                "tags": ["Elektrochemie", "Bleiakkumulator", "Elektrolyt", "Galvanische Zelle", "Redox", "Batterie"]
            },
            {
                "category": "Physikalische Chemie",
                "subcategory": "Elektrochemie",
                "displayName": "Starke und schwache Elektrolyte, Tafelwerk",
                "fileName": "starke_und_schwache_elektrolyte.html",
                "tags": ["Elektrolyte", "Stark", "Schwach", "Dissoziation", "Leitfähigkeit", "pKS"]
            },
            {
                "category": "Allgemeine Chemie",
                "subcategory": "Stoffmengenberechnungen",
                "displayName": "Konzentration, Berechnung, Beispiel",
                "fileName": "konzentration_umfassend.html",
                "tags": ["Konzentration", "Molalität", "Molarität", "Verdünnung", "Berechnung", "Löslichkeit"]
            },
            {
                "category": "Anorganische Chemie",
                "subcategory": "Redoxreaktionen",
                "displayName": "Reinigen von Silberschmuck, Gleichung, Beobachtung",
                "fileName": "reinigen_silberschmuck.html",
                "tags": ["Silberschmuck", "Redoxreaktion", "Silberoxid", "Reduktion", "Glanz", "Haushalt"]
            },
            {
                "category": "Physikalische Chemie",
                "subcategory": "Elektrochemie",
                "displayName": "Elektrochemie, Korrosion, Beispiel, Korrosionsschutz",
                "fileName": "elektrochemie_korrosion.html",
                "tags": ["Korrosion", "Rosten", "Korrosionsschutz", "Opferschutz", "Passivierung", "Eisen"]
            },
            {
                "category": "Physikalische Chemie",
                "subcategory": "Elektrochemie",
                "displayName": "Galvanische Zelle, Anodenraum, Kathodenraum",
                "fileName": "galvanische_zelle_1.html",
                "tags": ["Galvanische Zelle", "Anode", "Kathode", "Redox", "Spannung", "Daniell-Element"]
            },
            {
                "category": "Organische Chemie",
                "subcategory": "Chemisches Gleichgewicht",
                "displayName": "Chemisches Gleichgewicht, Esterbildung, Dynamisches Gleichgewicht",
                "fileName": "gleichgewicht_esterbildung.html",
                "tags": ["Esterbildung", "Gleichgewicht", "Veresterung", "Hydrolyse", "Säure", "Alkohol"]
            },
            {
                "category": "Physikalische Chemie",
                "subcategory": "Thermodynamik",
                "displayName": "Exotherme, Endotherme Reaktionen, Chemisches Gleichgewicht",
                "fileName": "exotherme_endotherme_reaktion_chemisches_gleichgewicht.html",
                "tags": ["Exotherm", "Endotherm", "Gleichgewicht", "Reaktionswärme", "Le Chatelier", "Temperatur"]
            },
            {
                "category": "Physikalische Chemie",
                "subcategory": "Chemisches Gleichgewicht",
                "displayName": "Chemisches Gleichgewicht, Gleichgewichtskonstante, Massenwirkungsgesetz",
                "fileName": "chemisches_gg_gleichgewichtskonstante.html",
                "tags": ["Gleichgewichtskonstante", "Massenwirkungsgesetz", "Kc", "Reaktionsquotient", "Dynamisch", "Konzentration"]
            },
            {
                "category": "Anorganische Chemie",
                "subcategory": "Säure-Base-Chemie",
                "displayName": "Säure-Base-Theorie, Lewis, Bronstedt, Protolyse, Ammoniak",
                "fileName": "saeure_base_lewis_bronstedt.html",
                "tags": ["Säure-Base", "Lewis", "Brønsted", "Protolyse", "Ammoniak", "pH-Wert"]
            },
            {
                "category": "Anorganische Chemie",
                "subcategory": "Säure-Base-Chemie",
                "displayName": "pH-Wert, Berechnen, Protolyte, Puffersysteme",
                "fileName": "ph_werte_berechnungen_puffersysteme.html",
                "tags": ["pH-Wert", "Berechnung", "Protolyte", "Puffer", "Henderson-Hasselbalch", "Titration"]
            },
            {
                "category": "Anorganische Chemie",
                "subcategory": "Lösungsprozesse",
                "displayName": "Lösen von Salzen, Lösungsenthalpie",
                "fileName": "salze_loesungsenthalpie.html",
                "tags": ["Salze", "Lösungsenthalpie", "Gitterenergie", "Hydratation", "Löslichkeit", "Kristall"]
            },
            {
                "category": "Anorganische Chemie",
                "subcategory": "Komplexchemie",
                "displayName": "Komplexverbindungen, Komplexstabilitätskonstante",
                "fileName": "komplexchemie_1.html",
                "tags": ["Komplexverbindungen", "Ligand", "Zentralion", "Stabilitätskonstante", "Chelat", "Farbigkeit"]
            },
            {
                "category": "Biochemie",
                "subcategory": "Proteine",
                "displayName": "Proteine, Nachweise, Aromaten, Peptide",
                "fileName": "proteine_nachweise_1.html",
                "tags": ["Proteine", "Nachweis", "Aromaten", "Peptide", "Biuret", "Ninhydrin"]
            }
        ];

        // Sortieren
        contentList.sort((a, b) => {
            if (a.category < b.category) return -1;
            if (a.category > b.category) return 1;
            if (a.subcategory < b.subcategory) return -1;
            if (a.subcategory > b.subcategory) return 1;
            return a.displayName.localeCompare(b.displayName);
        });

        // Inhaltsverzeichnis rendern
        const listElement = document.getElementById("contentList");
        const searchInput = document.getElementById("searchInput");
        const clearSearch = document.getElementById("clearSearch");

        function renderContentList(filterTerm = "") {
            listElement.innerHTML = "";
            let currentCategory = null;
            let currentSubcategory = null;
            let categoryHasMatches = false;
            let subcategoryHasMatches = false;

            contentList.forEach(item => {
                const searchTerm = filterTerm.toLowerCase();
                const displayName = item.displayName.toLowerCase();
                const category = item.category.toLowerCase();
                const subcategory = item.subcategory.toLowerCase();
                const tags = item.tags ? item.tags.map(tag => tag.toLowerCase()) : [];

                const displayNameMatches = !searchTerm || displayName.includes(searchTerm) || isFuzzyMatch(item.displayName, searchTerm);
                const tagMatches = !searchTerm || (tags && tags.some(tag => tag.includes(searchTerm) || isFuzzyMatch(tag, searchTerm)));
                const categoryMatches = !searchTerm || category.includes(searchTerm);
                const subcategoryMatches = !searchTerm || subcategory.includes(searchTerm);

                const matchesSearch = !searchTerm || categoryMatches || subcategoryMatches || displayNameMatches || tagMatches;

                if (matchesSearch && item.category !== currentCategory) {
                    const categoryElement = document.createElement("li");
                    categoryElement.className = "category";
                    categoryElement.textContent = item.category;
                    listElement.appendChild(categoryElement);
                    currentCategory = item.category;
                    currentSubcategory = null;
                    categoryHasMatches = true;
                }

                if (matchesSearch && item.subcategory !== currentSubcategory) {
                    const subcategoryElement = document.createElement("li");
                    subcategoryElement.className = "subcategory";
                    subcategoryElement.textContent = item.subcategory;
                    listElement.appendChild(subcategoryElement);
                    currentSubcategory = item.subcategory;
                    subcategoryHasMatches = true;
                }

                if (matchesSearch) {
                    const entryElement = document.createElement("li");
                    entryElement.className = "entry";
                    entryElement.innerHTML = `<a href="#" data-file="${item.fileName}">${item.displayName}</a>`;
                    listElement.appendChild(entryElement);
                }
            });
        }

        // Klick-Event für Links
        listElement.addEventListener("click", function(e) {
            if (e.target.tagName === "A") {
                e.preventDefault();
                const fileName = e.target.getAttribute("data-file");
                const frame = document.getElementById("contentFrame");
                frame.src = fileName;
                frame.onload = function() {
                    const mode = document.body.classList.contains("dark-mode") ? "dark" : "light";
                    frame.contentWindow.postMessage({ type: "setMode", mode: mode }, "*");
                    // Hash in URL setzen
                    window.location.hash = fileName;
                };
            }
        });

        // Suche
        searchInput.addEventListener("input", function() {
            renderContentList(this.value);
            clearSearch.style.display = this.value ? "flex" : "none";
        });

        // Clear-Search
        clearSearch.addEventListener("click", function() {
            searchInput.value = "";
            renderContentList("");
            clearSearch.style.display = "none";
        });

        // Dark/Light Mode
        const toggleButton = document.getElementById("toggleMode");
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.body.classList.add("dark-mode");
            toggleButton.textContent = "☀️";
        } else {
            document.body.classList.remove("dark-mode");
            toggleButton.textContent = "☽";
        }

        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
            document.body.classList.toggle("dark-mode", event.matches);
            toggleButton.textContent = event.matches ? "☀️" : "☽";
            const frame = document.getElementById("contentFrame");
            if (frame.contentWindow) {
                const mode = document.body.classList.contains("dark-mode") ? "dark" : "light";
                frame.contentWindow.postMessage({ type: "setMode", mode: mode }, "*");
            }
        });

        toggleButton.addEventListener("click", function() {
            document.body.classList.toggle("dark-mode");
            const mode = document.body.classList.contains("dark-mode") ? "dark" : "light";
            this.textContent = mode === "dark" ? "☀️" : "☽";
            const frame = document.getElementById("contentFrame");
            if (frame.contentWindow) {
                frame.contentWindow.postMessage({ type: "setMode", mode: mode }, "*");
            }
        });

        // Sidebar Toggle
        const sidebarToggle = document.getElementById("sidebarToggle");
        const sidebarWrapper = document.querySelector(".sidebar-wrapper");
        const sidebar = document.querySelector(".sidebar");
        const mainContent = document.querySelector(".main-content");

        sidebarToggle.addEventListener("click", function() {
            sidebarWrapper.classList.toggle("collapsed");
            sidebar.classList.toggle("collapsed");
            mainContent.classList.toggle("expanded");
        });

        // Toggle Mode Button Wrapper
        const toggleModeToggle = document.getElementById("toggleModeToggle");
        const toggleModeWrapper = document.querySelector(".toggle-mode-wrapper");

        toggleModeToggle.addEventListener("click", function() {
            toggleModeWrapper.classList.toggle("collapsed");
        });

        // Floating Buttons Toggle
        const floatingButtonToggle = document.getElementById("floatingButtonToggle");
        const floatingButtonWrapper = document.querySelector(".floating-button-wrapper");

        floatingButtonToggle.addEventListener("click", function() {
            floatingButtonWrapper.classList.toggle("collapsed");
        });

        // Frage stellen
        const frageButton = document.getElementById("frageButton");
        const frageInputMenu = document.getElementById("frageInputMenu");
        const frageInput = document.getElementById("frageInput");

        frageButton.addEventListener("click", function(e) {
            e.stopPropagation();
            frageInputMenu.classList.toggle("show");
            frageInput.focus();
        });

        frageInput.addEventListener("keydown", function(e) {
            if (e.key === "Enter" && this.value.trim()) {
                const frame = document.getElementById("contentFrame");
                frame.contentWindow.postMessage({ type: "getVisibleText" }, "*");
                frageInputMenu.classList.remove("show");
                frageButton.dataset.question = this.value.trim();
                this.value = "";
            }
        });

        // Toast Notification
        let isToastActive = false;
        let toastTimeout = null;

        function showToast(message, isError = false) {
            if (isToastActive) return;
            isToastActive = true;
            clearTimeout(toastTimeout);

            let toast = document.getElementById("toastNotification");
            if (!toast) {
                toast = document.createElement("div");
                toast.id = "toastNotification";
                toast.className = "toast-notification";
                document.body.appendChild(toast);
            }

            toast.textContent = message;
            toast.classList.add("show");

            toastTimeout = setTimeout(() => {
                toast.classList.remove("show");
                setTimeout(() => { isToastActive = false; }, 400);
            }, 3000);
        }

        // Quiz & Zusammenfassung
        const quizButton = document.getElementById("quizButton");
        const zusammenfassungButton = document.getElementById("zusammenfassungButton");

        quizButton.addEventListener("click", function() {
            if (isToastActive) return;
            const frame = document.getElementById("contentFrame");
            frame.contentWindow.postMessage({ type: "getVisibleText" }, "*");
            quizButton.dataset.active = "true";
        });

        zusammenfassungButton.addEventListener("click", function() {
            if (isToastActive) return;
            const frame = document.getElementById("contentFrame");
            frame.contentWindow.postMessage({ type: "getVisibleText" }, "*");
            zusammenfassungButton.dataset.active = "true";
        });

        // Antwort vom iframe
        window.addEventListener("message", (event) => {
            if (event.data.type === "visibleTextResponse") {
                const visibleText = event.data.text;

                if (zusammenfassungButton.dataset.active === "true") {
                    const promptText = "Fasse den nachstehenden Text kurz in wenigen Sätzen zusammen:\n\n" + visibleText;
                    navigator.clipboard.writeText(promptText)
                        .then(() => { showToast("Prompt für Zusammenfassung kopiert!"); })
                        .catch(err => { showToast("Fehler beim Kopieren.", true); });
                }
                else if (quizButton.dataset.active === "true") {
                    const promptText = "Erstelle 2 Fragen für eine Prüfung, die nur das Wissen aus den nachstehenden Informationen abfragen:\n\n" + visibleText;
                    navigator.clipboard.writeText(promptText)
                        .then(() => { showToast("Prompt für Quiz-Fragen kopiert!"); })
                        .catch(err => { showToast("Fehler beim Kopieren.", true); });
                }
                else if (frageButton.dataset.question) {
                    const promptText = `
### Spracheinstellungen ###

Du antwortest immer in deutscher Sprache.

### Rolle ###

Du bist eine Recherche KI für Naturwissenschaften, die sich mit Fragen zur Chemie auseinandersetzt.

### Aufgabe ###

Du führst Internetrecherchen durch. Du nutzt keine anderen Tools. Du antwortest nur mithilfe der Informationen aus der Internetrecherche und dem ursprünglich bereitgestellten Text. Wenn du keinen Zugriff auf eine Seite hast, überspringe diese eine Seite. Du gibst zu allen Informationen Fundstellen an.

### Anleitung ###

1. Vorbereitung

1.1. Speichere den Prompt des Users als String in USER_PROMPT.

1.2. Finde 5 chemische und sonstige Begriffe, die sich dem String in USER_PROMPT entnehmen lassen und von ihm ableiten. Füge den Begriffen immer den String " Chemie Abitur" am Ende bei. Speichere die Begriffe im Array USER_PROMPT_KEYWORDS.

2. Zwingende Recherchen

2.1. Für jeden Eintrag im Array USER_PROMPT_KEYWORDS durchsuchst du die Seiten:

"https://www.chemieunterricht.de/dc2/",
"https://www.simpleclub.com/topic/chemie-im-abi",
"https://www.sofatutor.com/chemie",
"https://www.studyhelp.de/online-lernen/chemie/",
"https://www.lernhelfer.de/schuelerlexikon/chemie-abitur",
"https://www.oberprima.com/chemie/",
"https://de.wikipedia.org",
"https://www.chemie-schule.de",
"https://www.studysmarter.de/studium/chemie-studium",
"https://www.studyflix.de/chemie",
"https://www.lernhelfer.de/schuelerlexikon/chemie-abitur",
"https://www.abitur-wissen.org,
"https://www.chemie.de" und
"https://www.abiweb.de"

und speicherst jeweils die gefundenen Plain Texte in INFORMATIONEN_STRING.

3. Antwortformulierung

3.1. Du formulierst deine Antwort nur mithilfe der Informationen im String INFORMATIONEN_STRING dem du auch den ursprünglichen Text beifügst. Du übernimmst Formulierungen und Fachbegriffe aus INFORMATIONEN_STRING.

User: Beantworte die Frage USER_PROMPT nur mithilfe der nachstehenden Informationen.\n\nInformationstexte: INFORMATIONEN_STRING.

User: 
                    ` + frageButton.dataset.question + "\n\nZusätzlich verwendest du auch diese nachstehenden Informationen:\n\n" + visibleText;
                    navigator.clipboard.writeText(promptText)
                        .then(() => { showToast("Prompt für Frage kopiert!"); })
                        .catch(err => { showToast("Fehler beim Kopieren.", true); });
                    frageButton.dataset.question = "";
                }

                quizButton.dataset.active = "false";
                zusammenfassungButton.dataset.active = "false";
            }
        });

        // Hash in URL auslesen und iframe laden
        function loadPageFromHash() {
            const hash = window.location.hash.substring(1);
            if (hash) {
                const frame = document.getElementById("contentFrame");
                frame.src = hash;
                frame.onload = function() {
                    const mode = document.body.classList.contains("dark-mode") ? "dark" : "light";
                    frame.contentWindow.postMessage({ type: "setMode", mode: mode }, "*");
                };
            } else {
                // Standardmäßig "e_ethin.html" laden, wenn kein Hash vorhanden ist
                document.getElementById("contentFrame").src = "e_ethin.html";
            }
        }

        // Erste Seite laden oder Hash auslesen
        loadPageFromHash();
        renderContentList();

        // Schließe Input-Menü bei Klick außerhalb
        document.addEventListener("click", function(e) {
            if (!frageInputMenu.contains(e.target) && e.target !== frageButton) {
                frageInputMenu.classList.remove("show");
            }
        });
    </script>
</body>
</html>
